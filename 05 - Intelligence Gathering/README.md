# Target Selection
When approaching a target organization it is important to understand that a company may have a number of different Top Level Domains (TDLs) and auxillary businesses. Verify what is in scope and then start to perform automated and manual intelligence gathering on the target.

# OSINT
Open Source Intelligence (OSINT) can take three forms; Passive, Semi-Passive, and Active

1. **Passive Information Gathering**: This is generally only useful if there is a clear requirement that the information gathering activities never be detected by the target.
2. **Semi-passive Information Gathering**: Profile the target with methods that would appear like normal internet traffic and behavior. Manual investigation of the company's website is an example.
3. **Active Information Gathering**: This activity should be detected by the target that looks suspicious and/or malicious.

## Corporate
Finding specific information about their business can be very useful such as:
1. Any possible pubilc github repositories that the company has
2. Physical address
3. Assoicated records (city, tax, legal, etc.)
4. Job openings

### Org Chart
Creating an organization chart can help define high-valued targets and who operates in what department. Alot of this information is most likely public that can be found on the company's website or social media platforms (Linkedin, Twitter, Facebook, Instagram, etc.).

### Individuals
Finding information about specific individuals of an organization can lead to possible username and password guessing. Information about specific individuals can usually be found online through social media.
- Tools to use:
    - http://www.geocreepy.com/

# Footprinting
Footprinting is external information gathering that consists of interaction with the target in order to gain information from a perspective external to the organization.

## External Footprinting
Determine what hosts are in scope and perform techniques to identify systems.

### Passive Reconnaissance
- Tools to use:
    - WhoIs Lookup: https://lookup.icann.org/
    - BGP4: https://www.bgp4.as/looking-glasses

### Active Footprinting
This type of footprinting deals with actively engaging with the target organization.

### ICMP
Simply pinging the machine can tell you valuable information such as the OS the target device is.
ICMP packets contain a field called Time to live (TTL) that shows the maximum number of hops a connection can take before its dropped.

Different Operating Systems (OS) use different TTL values. The most popular TTL values for each OS are:

| Operating System | Time to Live | TCP Window Size
--- | --- | --- 
Linux (Kernel 2.4 & 2.6) | 64 | 5840
Google Linux | 64 | 5720
FreeBSD | 64 | 65535
Windows XP | 128 | 65535
Windows Vista & 7 (Server 2008) | 128 | 8192
IOS 12.4 (Cisco Routers) | 255 | 4128

#### Port Scanning
- Tools to use:
    - Nmap: https://nmap.org/

#### Banner Grabbing
This enumeration technique can be used to obtain information about computer systems on a network, the services running its open ports, and specific version numbers the services are running on.
- Tools to use:
    - Telnet: https://linux.die.net/man/1/telnet
    - Netcat: https://linux.die.net/man/1/nc
    - Wget: https://linux.die.net/man/1/wget
    - Curl: https://linux.die.net/man/1/curl
    - DMitry: https://github.com/jaygreig86/dmitry

#### SNMP Sweeps
SNMP sweeps can be used to obtain information about a specific system.
- Tools to use:
    - snmpwalk: https://linux.die.net/man/1/snmpwalk
    - snmpset: https://linux.die.net/man/1/snmpset
    - Braa: https://github.com/mteg/braa

#### Zone Transfers
DNS zone transfers is a mechanism designed to replicate the databases containing the DNS data across a set of DNS servers.
- Tools to use:
    - host: https://linux.die.net/man/1/host
    - dig: https://linux.die.net/man/1/dig

#### SMTP Bounce Back & SMTP Enumeration
SMTP bounce back is an automated electronic mail message from a mail system informing the sender of another message about a delivery problem. This can be used to assist an attacker in fingerprinting the SMTP server that can include SMTP server information as well as software and versions.
- Tools to use:
    - smtp-user-enum: https://github.com/pentestmonkey/smtp-user-enum
    - iSMTP: https://gitlab.com/kalilinux/packages/ismtp
    - vrfy using Telnet: https://linux.die.net/man/1/telnet
    - Metasploit/auxillary/scanner/smtp/smtp-enum

#### Website Subdirectory Enumeration
Finding interesting files and subdirectories in an organization's website can be very useful for intelligence gathering and where potential vulnerabilities are.
- Tools to use:
    - Gobuster: https://github.com/OJ/gobuster
    - Dirbuster: https://tools.kali.org/web-applications/dirbuster
    - Nikto: https://cirt.net/Nikto2

#### Website Subdomain Enumeration
Finding subdomains of websites can lead to valuable information such as hidden subdomains used for development or subdomains containing web applications.
- Tools to use:
    - Gobuster: https://github.com/OJ/gobuster
    - Google Dorking: https://securitytrails.com/blog/google-hacking-techniques
    - DNSDumpster: https://dnsdumpster.com/
    - Amass: https://github.com/OWASP/Amass
    - Certificate Transparency: https://transparencyreport.google.com/https/certificates
    - AltDNS: https://github.com/infosec-au/altdns

#### Manipulating Web Requests
Manipulating web requests can lead to possible information leakage and can be used to test for various website-based vulnerabilities such as local file inclusion (LFI), cross-site scripting (XSS), insecure deserilization, etc. Refer to OWASP top 10: https://owasp.org/www-project-top-ten/
- Tools to use:
    - Burp Suite: https://portswigger.net/burp
    - ZAP: https://www.zaproxy.org/ 

## Internal Footprinting
Having access to an internal network can lead to further network exploitation.

### Passive Reconnaissance
Packet sniffing can lead to a great deal of information.
- Tools to use:
    - Wireshark: https://www.wireshark.org/
    - TCPDump: https://www.tcpdump.org/

# Identifying Protection Mechanisms
The following elements should be identified and mapped according to the relevant location/group/persons in scope. This will enable correct application of the vulnerability research and exploitation to be used when performing the actual attack - thus maximizing the efficiency of the attack, and minimizing the detection ratio.

1. Network Based Protections
    - "Simple" Packet Filters
    - Traffic Shaping Devices
    - DLP Systems
    - Encryption/Tunneling
2. Host Based Protections
    - Stack/Heap Protections
    - Application Whitelisting
    - AV/Filtering/Behavioral Analysis
    - DLP Systems
3. Application Level Protections
    - Identify Application Protections
    - Encoding Options
    - Potential Bypass Avenues
    - Whitelisted Pages
4. Storage Protections
    - HBA - Host Level
    - LUN Masking
    - Storage Controller
    - iSCSI CHAP Secret
5. User Protections
    - AV/Spam Filtering Software

# References:
http://www.pentest-standard.org/index.php/Intelligence_Gathering