# Scope
The scope of a penetration test clearly defines what is to be tested.
How each aspect of the penetration test will be covered in Rules of Engagement.

A key component of a penetration test is outlining how the testers should spend their time

# General Questions
Below are general questions that the client will have to answer in order for the engagement
scope to be properly estimated.

## Network Penetration Test
1. Why is the customer having the penetration test performed against their environment?
2. Is the penetration test required for a specific compliance requirement?
3. When does the customer want the active portions (scanning, enumeration, exploitation, etc...) of the penetration test conducted?
    1. During business hours?
    2. After business hours?
    3. On the weekends?
4. How many total IP addresses are being tested?
    1. How many internal IP addresses, if applicable?
    2. How many external IP addresses, if applicable?
5. Are there any devices in place that may impact the results of a penetration test such as a firewall, IDS/IPS, WAF, etc.
6. In the case that a system is penetrated, how should the testing team proceed?
    1. Perform a local vulnerability assessment on the compromised machine?
    2. Attempt to gain the highest privileges (root on Unix machines, SYSTEM or Administrator on Windows machines) on the compromised machine?
    3. Perform no, minimal, dictionary, or exhaustive password attacks against local password hashes obtained (/etc/shadow on Unix machines, SAM file on Windows machines)?

## Web Application Penetration Test
1. How many web applications are being assessed?
2. How many login systems are being assessed?
3. How many static pages are being assessed? (approximate)
4. How many dynamic pages are being assessed? (approximate)
5. Will the source code be made readily available?
6. Will there be any kind of documentation?
    1. If yes, what kind of documentation?
7. Will static analysis be performed on this application?
8. Does the client want fuzzing performed against this application?
9. Does the client want role-based testing performed against this application?
10. Does the client want credentialed scans of web applications performed?

## Wireless Network Penetration Test
1. How many wireless networks are in place?
2. Is a guest wireless network used? If so:
    1. Does the guest network require authentication?
    2. What type of encryption is used on the wireless networks?
    3. What is the square footage of coverage?
    4. Will enumeration of rogue devices be necessary?
    5. Will the team be assessing wireless attacks against clients?
    6. Approximately how many clients will be using the wireless network?

## Physical Penetration Testi
1. How many locations are being assessed?
2. Is this physical location a shared facility? If so:
    1. How many floors are in scope?
    2. Which floors are in scope?
3. Are there any security guards that will need to be bypassed? If so:
    1. Are the security guards employed through a 3rd party?
    2. Are they armed?
    3. Are they allowed to use force?
4. How many entrances are there into the building?
5. Is the use of lock picks or bump keys allowed? (also consider local laws)
6. Is the purpose of this test to verify compliance with existing policies and procedures or for performing an audit?
7. What is the square footage of the area in scope?
8. Are all physical security measures documented?
9. Are video cameras being used?
    1. Are the cameras client-owned? If so:
        1. Should the team attempt to gain access to where the video camera data is stored?
10. Is there an armed alarm system being used? If so:
    1. Is the alarm a silent alarm?
    2. Is the alarm triggered by motion?
    3. Is the alarm triggered by opening of doors and windows?

## Social Engineering
1. Does the client have a list of email addresses they would like a Social Engineering attack to be performed against?
2. Does the client have a list of phone numbers they would like a Social Engineering attack to be performed against?
3. Is Social Engineering for the purpose of gaining unauthorized physical access approved? If so:
    1. How many people will be targeted?

Questions for Business Unit Managers, System Administrators, and Help Desk Personel may not be required.
However, in case these questions are necessary, refer to the questions below.

## Questions for Business Unit Managers
1. Is the manager aware that a test is about to be performed?
2. What is the main datum that would create the greatest risk to the organization if exposed, corrupted, or deleted?
3. Are testing and validation procedures to verify that business applications are functioning properly in place?
4. Will the testers have access to the Quality Assurance testing procedures from when the application was first developed?
5. Are Disaster Recovery Procedures in place for the application data?

## Questions for Systems Administrators
1. Are there any systems which could be characterized as fragile? (systems with tendencies to crash, older operating systems, or which are unpatched)
2. Are there systems on the network which the client does not own, that may require additional approval to test?
3. Are Change Management procedures in place?
4. What is the mean time to repair systems outages?
5. Is any system monitoring software in place?
6. What are the most critical servers and applications?
7. Are backups tested on a regular basis?
8. When was the last time the backups were restored?

# Specify Start and End Dates
A key component of Pre-Engagement is to explicitly define the start and end dates.

# Specify IP Ranges and Domains
Before starting a penetration test, all targets must be identified. Internal and external targets should be obtained from the customer
during the initial questionnaire phase. The targets can be given in the form of specific IP adresses, network ranges, or domain names
by the customer. It is important to define if systems like firewalls and IDS/IPS or networking equipment between the tester and the
final target are also part of the scope. 3rd party providers and upstream providers should also be identified and defined whether
they are in scope or not.

# Dealing with 3rd Parties
Although permission from the client may have been given, they do not speak for their 3rd party providers. A great example of this
is cloud providers, ISP, and MSSPs (Managed Security Service Providers).

# Defining Goals
Penetration tests should have a clear goal in mind. The general purpose is to identify specific vulnerabilities that could lead to compromise
of the business or mission objectives of the customer.

# Lines of Communication
One of the most important aspects of a penetration test is communication with the customer.

## Emergency Contact Information
If emergencies arise, a clear point of contact should be documented and an emergency contact list should be created.

Information about each emergency contact should be documented:
1. Full name
2. Title and operational responsibility
3. Authorization to discuss details of the testing activities, if not already specified
4. Two forms of 24/7 immediate contact, such as cell phone, pager, or home phone, if possible
5. One form of secure bulk data transfer, such as SFTP or encrypted email

# Rules of Engagement
The scope defines what will be tested, the rules of engagement define how it will be tested.

## Timeline
A clear timeline should be tested for the engagement. It should be understood that the timeline will change
as the test progresses. Having a timeline in place at the beginning of a test will allow everyone involved
to more clearly identify the work that is to be done and the people who will be responsible for said work.

## Locations
A parameter of a penetration test to be established ahead of time is any destinations to which the tester will
need to travel during the test. If no travel will be used, VPN connections to the site should be set up for
remote testing.

## Evidence Handling
When handling evidence of a test and the different stages of the report, it is incredibly important to take extreme care with the data. Always use encryption and sanitize your test machine between tests. Do not re-use a report from another customer engagement as a template, it is very unprofessional to leave references to another organization in your document.

## Regular Status Meetings
Throughout the testing process it is critical to have regular meetings with the customer to inform them of the progress of the test. Meetings should be kept to three concepts: plans, progress, and problems.

## Time of the Day to Test
Certain customers require that all testing be performed outside of business hours. The time of day requirements should be well established with the customer before testing begins.

## Permission to Test
One of the most important documents which need to be obtained for a penetration test is the Permission to Test document. This document states the scope and contains a signature which acknowledges awareness of the activity of the testers. It should clearly state that testing can lead to system instability and all due care will be given by the tester to not crash any systems during the test.

## Legal Considerations
Checking the legality of common penetration testing tasks in the location where the work is to be performed is highly advised.

# Capabilities and Technology in Place
Good penetration tests do not simply check for un-patched systems. They also test the capabilities of the target organization. To that end, below is a list of things that you can benchmark while testing.

1. Ability to detect and respond to information gathering
2. Ability to detect and respond to foot printing
3. Ability to detect and respond to scanning and vuln analysis
4. Ability to detect and respond to infiltration (attacks)
5. Ability to detect and respond to data aggregation
6. Ability to detect and respond to data ex-filtration

When tracking this information be sure to collect time information. For example, if a scan is detected you should be notified and note what level of scan you were preforming at the time.

# References
Pre-Engagment: http://www.pentest-standard.org/index.php/Pre-engagement
Scope Document: https://www.sans.org/security-resources/posters/pen-testing/pen-test-scope-worksheet-255
Rules of Engagement Document: https://www.sans.org/security-resources/posters/pen-testing/pen-test-rules-engagement-worksheet-250